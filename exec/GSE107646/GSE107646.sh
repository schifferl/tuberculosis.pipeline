#!/bin/bash -l

#$ -e /dev/null
#$ -o /dev/null
#$ -P tuberculosis
#$ -pe omp 16
#$ -t 1-921

module load sratoolkit/2.10.5
module load nextflow/19.10.0

INDEX=$(($SGE_TASK_ID-1))

INPUT=(SRR6342373 SRR6342374 SRR6342375 SRR6342376 SRR6342377 SRR6342378 SRR6342379 SRR6342380 SRR6342381 SRR6342382 SRR6342383 SRR6342384 SRR6342385 SRR6342386 SRR6342387 SRR6342388 SRR6342389 SRR6342390 SRR6342391 SRR6342392 SRR6342393 SRR6342394 SRR6342395 SRR6342396 SRR6342397 SRR6342398 SRR6342399 SRR6342400 SRR6342401 SRR6342402 SRR6342403 SRR6342404 SRR6342405 SRR6342406 SRR6342407 SRR6342408 SRR6342409 SRR6342410 SRR6342411 SRR6342412 SRR6342413 SRR6342414 SRR6342415 SRR6342416 SRR6342417 SRR6342418 SRR6342419 SRR6342420 SRR6342421 SRR6342422 SRR6342423 SRR6342424 SRR6342425 SRR6342426 SRR6342427 SRR6342428 SRR6342429 SRR6342430 SRR6342431 SRR6342432 SRR6342433 SRR6342434 SRR6342435 SRR6342436 SRR6342437 SRR6342438 SRR6342439 SRR6342440 SRR6342441 SRR6342442 SRR6342443 SRR6342444 SRR6342445 SRR6342446 SRR6342447 SRR6342448 SRR6342449 SRR6342450 SRR6342451 SRR6342452 SRR6342453 SRR6342454 SRR6342455 SRR6342456 SRR6342457 SRR6342458 SRR6342459 SRR6342460 SRR6342461 SRR6342462 SRR6342463 SRR6342464 SRR6342465 SRR6342466 SRR6342467 SRR6342468 SRR6342469 SRR6342470 SRR6342471 SRR6342472 SRR6342473 SRR6342474 SRR6342475 SRR6342476 SRR6342477 SRR6342478 SRR6342479 SRR6342480 SRR6342481 SRR6342482 SRR6342483 SRR6342484 SRR6342485 SRR6342486 SRR6342487 SRR6342488 SRR6342489 SRR6342490 SRR6342491 SRR6342492 SRR6342493 SRR6342494 SRR6342495 SRR6342496 SRR6342497 SRR6342498 SRR6342499 SRR6342500 SRR6342501 SRR6342502 SRR6342503 SRR6342504 SRR6342505 SRR6342506 SRR6342507 SRR6342508 SRR6342509 SRR6342510 SRR6342511 SRR6342512 SRR6342513 SRR6342514 SRR6342515 SRR6342516 SRR6342517 SRR6342518 SRR6342519 SRR6342520 SRR6342521 SRR6342522 SRR6342523 SRR6342524 SRR6342525 SRR6342526 SRR6342527 SRR6342528 SRR6342529 SRR6342530 SRR6342531 SRR6342532 SRR6342533 SRR6342534 SRR6342535 SRR6342536 SRR6342537 SRR6342538 SRR6342539 SRR6342540 SRR6342541 SRR6342542 SRR6342543 SRR6342544 SRR6342545 SRR6342546 SRR6342547 SRR6342548 SRR6342549 SRR6342550 SRR6342551 SRR6342552 SRR6342553 SRR6342554 SRR6342555 SRR6342556 SRR6342557 SRR6342558 SRR6342559 SRR6342560 SRR6342561 SRR6342562 SRR6342563 SRR6342564 SRR6342565 SRR6342566 SRR6342567 SRR6342568 SRR6342569 SRR6342570 SRR6342571 SRR6342572 SRR6342573 SRR6342574 SRR6342575 SRR6342576 SRR6342577 SRR6342578 SRR6342579 SRR6342580 SRR6342581 SRR6342582 SRR6342583 SRR6342584 SRR6342585 SRR6342586 SRR6342587 SRR6342588 SRR6342589 SRR6342590 SRR6342591 SRR6342592 SRR6342593 SRR6342594 SRR6342595 SRR6342596 SRR6342597 SRR6342598 SRR6342599 SRR6342600 SRR6342601 SRR6342602 SRR6342603 SRR6342604 SRR6342605 SRR6342606 SRR6342607 SRR6342608 SRR6342609 SRR6342646 SRR6342647 SRR6342648 SRR6342649 SRR6342650 SRR6342651 SRR6342652 SRR6342653 SRR6342654 SRR6342655 SRR6342656 SRR6342658 SRR6342659 SRR6342660 SRR6342661 SRR6342662 SRR6342663 SRR6342664 SRR6342665 SRR6342666 SRR6342667 SRR6342669 SRR6342670 SRR6342671 SRR6342672 SRR6342673 SRR6342674 SRR6342675 SRR6342676 SRR6342677 SRR6342679 SRR6342680 SRR6342681 SRR6342682 SRR6342683 SRR6342684 SRR6342685 SRR6342686 SRR6342687 SRR6342688 SRR6342689 SRR6342690 SRR6342691 SRR6342692 SRR6342693 SRR6342694 SRR6342695 SRR6342696 SRR6342697 SRR6342698 SRR6342699 SRR6342700 SRR6342701 SRR6342702 SRR6342703 SRR6342704 SRR6342705 SRR6342706 SRR6342707 SRR6342708 SRR6342709 SRR6342710 SRR6342711 SRR6342712 SRR6342713 SRR6342714 SRR6342715 SRR6342716 SRR6342717 SRR6342718 SRR6342719 SRR6342720 SRR6342721 SRR6342722 SRR6342723 SRR6342724 SRR6342725 SRR6342726 SRR6342727 SRR6342728 SRR6342729 SRR6342730 SRR6342731 SRR6342732 SRR6342733 SRR6342734 SRR6342735 SRR6342736 SRR6342737 SRR6342738 SRR6342739 SRR6342782 SRR6342783 SRR6342784 SRR6342785 SRR6342786 SRR6342787 SRR6342788 SRR6342789 SRR6342790 SRR6342791 SRR6342792 SRR6342793 SRR6342794 SRR6342795 SRR6342796 SRR6342797 SRR6342798 SRR6342799 SRR6342800 SRR6342801 SRR6342802 SRR6342803 SRR6342804 SRR6342805 SRR6342806 SRR6342807 SRR6342808 SRR6342809 SRR6342810 SRR6342811 SRR6342812 SRR6342813 SRR6342814 SRR6342815 SRR6342816 SRR6342817 SRR6342818 SRR6342819 SRR6342820 SRR6342821 SRR6342822 SRR6342823 SRR6342824 SRR6342825 SRR6342826 SRR6342827 SRR6342828 SRR6342829 SRR6342830 SRR6342831 SRR6342832 SRR6342833 SRR6342834 SRR6342835 SRR6342836 SRR6342837 SRR6342838 SRR6342839 SRR6342840 SRR6342841 SRR6342842 SRR6342843 SRR6342844 SRR6342845 SRR6342846 SRR6342847 SRR6342848 SRR6342849 SRR6342850 SRR6342851 SRR6342852 SRR6342853 SRR6342854 SRR6342855 SRR6342856 SRR6342857 SRR6342858 SRR6342859 SRR6342860 SRR6342861 SRR6342862 SRR6342863 SRR6342864 SRR6342865 SRR6342866 SRR6342867 SRR6342868 SRR6342869 SRR6342870 SRR6342871 SRR6342872 SRR6342873 SRR6342874 SRR6342875 SRR6342876 SRR6342877 SRR6342878 SRR6342879 SRR6342880 SRR6342881 SRR6342882 SRR6342883 SRR6342884 SRR6342885 SRR6342886 SRR6342887 SRR6342888 SRR6342889 SRR6342890 SRR6342891 SRR6342892 SRR6342893 SRR6342894 SRR6342895 SRR6342896 SRR6342897 SRR6342898 SRR6342899 SRR6342900 SRR6342901 SRR6342902 SRR6342903 SRR6342904 SRR6342905 SRR6342906 SRR6342907 SRR6342908 SRR6342909 SRR6342910 SRR6342911 SRR6342912 SRR6342913 SRR6342914 SRR6342915 SRR6342916 SRR6342917 SRR6342918 SRR6342919 SRR6342920 SRR6342921 SRR6342922 SRR6342923 SRR6342924 SRR6342925 SRR6342926 SRR6342927 SRR6342928 SRR6342929 SRR6342930 SRR6342931 SRR6342932 SRR6342933 SRR6342934 SRR6342935 SRR6342936 SRR6342937 SRR6342938 SRR6342939 SRR6342940 SRR6342941 SRR6342942 SRR6342943 SRR6342944 SRR6342945 SRR6342946 SRR6342947 SRR6342948 SRR6342949 SRR6342950 SRR6342951 SRR6342952 SRR6342953 SRR6342954 SRR6342955 SRR6342956 SRR6342957 SRR6342958 SRR6342959 SRR6342960 SRR6342961 SRR6342962 SRR6342963 SRR6342964 SRR6342965 SRR6342966 SRR6342967 SRR6342968 SRR6342969 SRR6342970 SRR6342971 SRR6342972 SRR6342973 SRR6342974 SRR6342975 SRR6342976 SRR6342977 SRR6342978 SRR6342979 SRR6342980 SRR6342981 SRR6342982 SRR6342983 SRR6342984 SRR6342985 SRR6342986 SRR6342987 SRR6342988 SRR6342989 SRR6342990 SRR6342991 SRR6342992 SRR6342993 SRR6342994 SRR6342995 SRR6342996 SRR6342997 SRR6342998 SRR6342999 SRR6343000 SRR6343001 SRR6343002 SRR6343003 SRR6343004 SRR6343005 SRR6343006 SRR6343007 SRR6343008 SRR6343009 SRR6343010 SRR6343011 SRR6343012 SRR6343013 SRR6343014 SRR6343015 SRR6343016 SRR6343017 SRR6343018 SRR6343019 SRR6343020 SRR6343021 SRR6343022 SRR6343023 SRR6343024 SRR6343025 SRR6343026 SRR6343027 SRR6343028 SRR6343029 SRR6343030 SRR6343031 SRR6343032 SRR6343033 SRR6343034 SRR6343035 SRR6343036 SRR6343037 SRR6343038 SRR6343039 SRR6343040 SRR6343041 SRR6343042 SRR6343043 SRR6343044 SRR6343045 SRR6343046 SRR6343047 SRR6343048 SRR6343049 SRR6343050 SRR6343051 SRR6343052 SRR6343053 SRR6343054 SRR6343055 SRR6343056 SRR6343057 SRR6343058 SRR6343059 SRR6343060 SRR6343061 SRR6343062 SRR6343063 SRR6343064 SRR6343065 SRR6343066 SRR6343067 SRR6343068 SRR6343069 SRR6343070 SRR6343071 SRR6343072 SRR6343073 SRR6343074 SRR6343075 SRR6343076 SRR6343077 SRR6343078 SRR6343079 SRR6343080 SRR6343081 SRR6343082 SRR6343083 SRR6343084 SRR6343085 SRR6343086 SRR6343087 SRR6343088 SRR6343089 SRR6343090 SRR6343091 SRR6343092 SRR6343093 SRR6343094 SRR6343095 SRR6343096 SRR6343097 SRR6343098 SRR6343099 SRR6343100 SRR6343101 SRR6343102 SRR6343103 SRR6343104 SRR6343105 SRR6343106 SRR6343107 SRR6343108 SRR6343109 SRR6343110 SRR6343111 SRR6343112 SRR6343113 SRR6343114 SRR6343115 SRR6343116 SRR6343117 SRR6343118 SRR6343119 SRR6343120 SRR6343121 SRR6343122 SRR6343123 SRR6343124 SRR6343125 SRR6343126 SRR6343127 SRR6343128 SRR6343129 SRR6343130 SRR6343131 SRR6343132 SRR6343133 SRR6343134 SRR6343135 SRR6343136 SRR6343137 SRR6343138 SRR6343139 SRR6343140 SRR6343141 SRR6343142 SRR6343143 SRR6343144 SRR6343145 SRR6343146 SRR6343147 SRR6343148 SRR6343149 SRR6343150 SRR6343151 SRR6343152 SRR6343153 SRR6343154 SRR6343155 SRR6343156 SRR6343157 SRR6343158 SRR6343159 SRR6343160 SRR6343161 SRR6343162 SRR6343163 SRR6343164 SRR6343165 SRR6343166 SRR6343167 SRR6343168 SRR6343169 SRR6343170 SRR6343171 SRR6343172 SRR6343173 SRR6343174 SRR6343175 SRR6343176 SRR6343177 SRR6343178 SRR6343179 SRR6343180 SRR6343181 SRR6343182 SRR6343183 SRR6343184 SRR6343185 SRR6343186 SRR6343187 SRR6343188 SRR6343189 SRR6343190 SRR6343191 SRR6343192 SRR6343193 SRR6343194 SRR6343195 SRR6343196 SRR6343197 SRR6343198 SRR6343199 SRR6343200 SRR6343201 SRR6343202 SRR6343203 SRR6343204 SRR6343205 SRR6343206 SRR6343207 SRR6343208 SRR6343209 SRR6343210 SRR6343211 SRR6343212 SRR6343213 SRR6343214 SRR6343215 SRR6343216 SRR6343217 SRR6343218 SRR6343219 SRR6343220 SRR6343221 SRR6343222 SRR6343223 SRR6343224 SRR6343225 SRR6343226 SRR6343227 SRR6343228 SRR6343229 SRR6343230 SRR6343231 SRR6343232 SRR6343233 SRR6343234 SRR6343235 SRR6343236 SRR6343237 SRR6343238 SRR6343239 SRR6343240 SRR6343241 SRR6343242 SRR6343243 SRR6343244 SRR6343245 SRR6343246 SRR6343247 SRR6343248 SRR6343249 SRR6343250 SRR6343251 SRR6343252 SRR6343253 SRR6343254 SRR6343255 SRR6343256 SRR6343257 SRR6343258 SRR6343259 SRR6343260 SRR6343261 SRR6343262 SRR6343263 SRR6343264 SRR6343265 SRR6343266 SRR6343267 SRR6343268 SRR6343269 SRR6343270 SRR6343271 SRR6343272 SRR6343273 SRR6343274 SRR6343275 SRR6343276 SRR6343277 SRR6343278 SRR6343279 SRR6343280 SRR6343281 SRR6343282 SRR6343283 SRR6343284 SRR6343285 SRR6343286 SRR6343287 SRR6343288 SRR6343289 SRR6343290 SRR6343291 SRR6343292 SRR6343293 SRR6343294 SRR6343295 SRR6343296 SRR6343297 SRR6343298 SRR6343299 SRR6343300 SRR6343301 SRR6343302 SRR6343303 SRR6343304 SRR6343305 SRR6343306 SRR6343307 SRR6343308 SRR6343309 SRR6343310 SRR6343311 SRR6343312 SRR6343313 SRR6343314 SRR6343315 SRR6343316 SRR6343317 SRR6343318 SRR6343319 SRR6343320 SRR6343321 SRR6343322 SRR6343323 SRR6343324 SRR6343325 SRR6343326 SRR6343327 SRR6343328 SRR6343329 SRR6343330 SRR6343331 SRR6343332 SRR6343333 SRR6343334 SRR6343335 SRR6343336 SRR6343337 SRR6343338 SRR6343339 SRR6343340 SRR6343341 SRR6343342 SRR6343343 SRR6343344 SRR6343345 SRR6343346 SRR6343347 SRR6343348 SRR6343349 SRR6343350 SRR6343351 SRR6343352 SRR6343353 SRR6343354 SRR6343355 SRR6343356 SRR6343357 SRR6343358 SRR6343359 SRR6343360 SRR6343361 SRR6343362 SRR6343363 SRR6343364 SRR6343365 SRR6343366 SRR6343367 SRR6343368 SRR6343369 SRR6343370 SRR6343371 SRR6343372 SRR6343373 SRR6343374)
SRRID=${INPUT[$INDEX]}

SERIES_LIBRARY_LAYOUT=(PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED)
SAMPLE_LIBRARY_LAYOUT=${SERIES_LIBRARY_LAYOUT[$INDEX]}

if [[ -e "$SRRID.tsv.gz" ]]; then
  exit
fi

prefetch --output-directory "/scratch/$USER" $SRRID | grep "\S" &> "$SRRID.log"
fasterq-dump --outdir "/scratch/$USER/$SRRID" --temp "/scratch/$USER/$SRRID" --threads 16 "/scratch/$USER/$SRRID" &>> "$SRRID.log"

if [[ $SAMPLE_LIBRARY_LAYOUT == "PAIRED" ]]; then
  nextflow run -profile singularity -revision 1.4.2 -work-dir "/scratch/$USER/$SRRID/work" nf-core/rnaseq --reads "/scratch/$USER/$SRRID/*{1,2}.fastq" --genome GRCh38 --skipBiotypeQC --outdir "/scratch/$USER/$SRRID/results" &>> "$SRRID.log"
fi

if [[ $SAMPLE_LIBRARY_LAYOUT == "SINGLE" ]]; then
  nextflow run -profile singularity -revision 1.4.2 -work-dir "/scratch/$USER/$SRRID/work" nf-core/rnaseq --reads "/scratch/$USER/$SRRID/*.fastq" --singleEnd --genome GRCh38 --skipBiotypeQC --outdir "/scratch/$USER/$SRRID/results" &>> "$SRRID.log"
fi

if [[ -n $(grep -l "Succeeded   : 13" "$SRRID.log") ]]; then
  gzip --stdout "/scratch/$USER/$SRRID/results/featureCounts/merged_gene_counts.txt" > "$SRRID.tsv.gz"
fi

rm -rf "/scratch/$USER/$SRRID"

