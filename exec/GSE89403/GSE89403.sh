#!/bin/bash -l

#$ -e /dev/null
#$ -o /dev/null
#$ -P tuberculosis
#$ -pe omp 16
#$ -t 1-914

module load sratoolkit/2.10.5
module load nextflow/19.10.0

INDEX=$(($SGE_TASK_ID-1))

INPUT=(SRR4784227 SRR4784228 SRR4784229 SRR4784230 SRR4784231 SRR4784232 SRR4784233 SRR4784234 SRR4784235 SRR4784236 SRR4784237 SRR4784238 SRR4784239 SRR4784240 SRR4784241 SRR4784242 SRR4784243 SRR4784244 SRR4784245 SRR4784246 SRR4784247 SRR4784248 SRR4784249 SRR4784250 SRR4784251 SRR4784252 SRR4784253 SRR4784254 SRR4784255 SRR4784256 SRR4784257 SRR4784258 SRR4784259 SRR4784260 SRR4784261 SRR4784262 SRR4784263 SRR4784264 SRR4784265 SRR4784266 SRR4784267 SRR4784268 SRR4784269 SRR4784270 SRR4784271 SRR4784272 SRR4784273 SRR4784274 SRR4784275 SRR4784276 SRR4784277 SRR4784278 SRR4784279 SRR4784280 SRR4784281 SRR4784282 SRR4784283 SRR4784284 SRR4784285 SRR4784286 SRR4784287 SRR4784288 SRR4784289 SRR4784290 SRR4784291 SRR4784292 SRR4784293 SRR4784294 SRR4784295 SRR4784296 SRR4784297 SRR4784298 SRR4784299 SRR4784300 SRR4784301 SRR4784302 SRR4784303 SRR4784304 SRR4784305 SRR4784306 SRR4784307 SRR4784308 SRR4784309 SRR4784310 SRR4784311 SRR4784312 SRR4784313 SRR4784314 SRR4784315 SRR4784316 SRR4784317 SRR4784318 SRR4784319 SRR4784320 SRR4784321 SRR4784322 SRR4784323 SRR4784324 SRR4784325 SRR4784326 SRR4784327 SRR4784328 SRR4784329 SRR4784330 SRR4784331 SRR4784332 SRR4784333 SRR4784334 SRR4784335 SRR4784336 SRR4784337 SRR4784338 SRR4784339 SRR4784340 SRR4784341 SRR4784342 SRR4784343 SRR4784344 SRR4784345 SRR4784346 SRR4784347 SRR4784348 SRR4784349 SRR4784350 SRR4784351 SRR4784352 SRR4784353 SRR4784354 SRR4784355 SRR4784356 SRR4784357 SRR4784358 SRR4784359 SRR4784360 SRR4784361 SRR4784362 SRR4784363 SRR4784364 SRR4784365 SRR4784366 SRR4784367 SRR4784368 SRR4784369 SRR4784370 SRR4784371 SRR4784372 SRR4784373 SRR4784374 SRR4784375 SRR4784376 SRR4784377 SRR4784378 SRR4784379 SRR4784380 SRR4784381 SRR4784382 SRR4784383 SRR4784384 SRR4784385 SRR4784386 SRR4784387 SRR4784388 SRR4784389 SRR4784390 SRR4784391 SRR4784392 SRR4784393 SRR4784394 SRR4784395 SRR4784396 SRR4784397 SRR4784398 SRR4784399 SRR4784400 SRR4784401 SRR4784402 SRR4784403 SRR4784404 SRR4784405 SRR4784406 SRR4784407 SRR4784408 SRR4784409 SRR4784410 SRR4784411 SRR4784412 SRR4784413 SRR4784414 SRR4784415 SRR4784416 SRR4784417 SRR4784418 SRR4784419 SRR4784420 SRR4784421 SRR4784422 SRR4784423 SRR4784424 SRR4784425 SRR4784426 SRR4784427 SRR4784428 SRR4784429 SRR4784430 SRR4784431 SRR4784432 SRR4784433 SRR4784434 SRR4784435 SRR4784436 SRR4784437 SRR4784438 SRR4784439 SRR4784440 SRR4784441 SRR4784442 SRR4784443 SRR4784444 SRR4784445 SRR4784446 SRR4784447 SRR4784448 SRR4784449 SRR4784450 SRR4784451 SRR4784452 SRR4784453 SRR4784454 SRR4784455 SRR4784456 SRR4784457 SRR4784458 SRR4784459 SRR4784460 SRR4784461 SRR4784462 SRR4784463 SRR4784464 SRR4784465 SRR4784466 SRR4784467 SRR4784468 SRR4784469 SRR4784470 SRR4784471 SRR4784472 SRR4784473 SRR4784474 SRR4784475 SRR4784476 SRR4784477 SRR4784478 SRR4784479 SRR4784480 SRR4784481 SRR4784482 SRR4784483 SRR4784484 SRR4784485 SRR4784486 SRR4784487 SRR4784488 SRR4784489 SRR4784490 SRR4784491 SRR4784492 SRR4784493 SRR4784494 SRR4784495 SRR4784496 SRR4784497 SRR4784498 SRR4784499 SRR4784500 SRR4784501 SRR4784502 SRR4784503 SRR4784504 SRR4784505 SRR4784506 SRR4784507 SRR4784508 SRR4784509 SRR4784510 SRR4784511 SRR4784512 SRR4784513 SRR4784514 SRR4784515 SRR4784516 SRR4784517 SRR4784518 SRR4784519 SRR4784520 SRR4784521 SRR4784522 SRR4784523 SRR4784524 SRR4784525 SRR4784526 SRR4784527 SRR4784528 SRR4784529 SRR4784530 SRR4784531 SRR4784532 SRR4784533 SRR4784534 SRR4784535 SRR4784536 SRR4784537 SRR4784538 SRR4784539 SRR4784540 SRR4784541 SRR4784542 SRR4784543 SRR4784544 SRR4784545 SRR4784546 SRR4784547 SRR4784548 SRR4784549 SRR4784550 SRR4784551 SRR4784552 SRR4784553 SRR4784554 SRR4784555 SRR4784556 SRR4784557 SRR4784558 SRR4784559 SRR4784560 SRR4784561 SRR4784562 SRR4784563 SRR4784564 SRR4784565 SRR4784566 SRR4784567 SRR4784568 SRR4784569 SRR4784570 SRR4784571 SRR4784572 SRR4784573 SRR4784574 SRR4784575 SRR4784576 SRR4784577 SRR4784578 SRR4784579 SRR4784580 SRR4784581 SRR4784582 SRR4784583 SRR4784584 SRR4784585 SRR4784586 SRR4784587 SRR4784588 SRR4784589 SRR4784590 SRR4784591 SRR4784592 SRR4784593 SRR4784594 SRR4784595 SRR4784596 SRR4784597 SRR4784598 SRR4784599 SRR4784600 SRR4784601 SRR4784602 SRR4784603 SRR4784604 SRR4784605 SRR4784606 SRR4784607 SRR4784608 SRR4784609 SRR4784610 SRR4784611 SRR4784612 SRR4784613 SRR4784614 SRR4784615 SRR4784616 SRR4784617 SRR4784618 SRR4784619 SRR4784620 SRR4784621 SRR4784622 SRR4784623 SRR4784624 SRR4784625 SRR4784626 SRR4784627 SRR4784628 SRR4784629 SRR4784630 SRR4784631 SRR4784632 SRR4784633 SRR4784634 SRR4784635 SRR4784636 SRR4784637 SRR4784638 SRR4784639 SRR4784640 SRR4784641 SRR4784642 SRR4784643 SRR4784644 SRR4784645 SRR4784646 SRR4784647 SRR4784648 SRR4784649 SRR4784650 SRR4784651 SRR4784652 SRR4784653 SRR4784654 SRR4784655 SRR4784656 SRR4784657 SRR4784658 SRR4784659 SRR4784660 SRR4784661 SRR4784662 SRR4784663 SRR4784664 SRR4784665 SRR4784666 SRR4784667 SRR4784668 SRR4784669 SRR4784670 SRR4784671 SRR4784672 SRR4784673 SRR4784674 SRR4784675 SRR4784676 SRR4784677 SRR4784678 SRR4784679 SRR4784680 SRR4784681 SRR4784682 SRR4784683 SRR4784684 SRR4784685 SRR4784686 SRR4784687 SRR4784688 SRR4784689 SRR4784690 SRR4784691 SRR4784692 SRR4784693 SRR4784694 SRR4784695 SRR4784696 SRR4784697 SRR4784698 SRR4784699 SRR4784700 SRR4784701 SRR4784702 SRR4784703 SRR4784704 SRR4784705 SRR4784706 SRR4784707 SRR4784708 SRR4784709 SRR4784710 SRR4784711 SRR4784712 SRR4784713 SRR4784714 SRR4784715 SRR4784716 SRR4784717 SRR4784718 SRR4784719 SRR4784720 SRR4784721 SRR4784722 SRR4784723 SRR4784724 SRR4784725 SRR4784726 SRR4784727 SRR4784728 SRR4784729 SRR4784730 SRR4784731 SRR4784732 SRR4784733 SRR4784734 SRR4784735 SRR4784736 SRR4784737 SRR4784738 SRR4784739 SRR4784740 SRR4784741 SRR4784742 SRR4784743 SRR4784744 SRR4784745 SRR4784746 SRR4784747 SRR4784748 SRR4784749 SRR4784750 SRR4784751 SRR4784752 SRR4784753 SRR4784754 SRR4784755 SRR4784756 SRR4784757 SRR4784758 SRR4784759 SRR4784760 SRR4784761 SRR4784762 SRR4784763 SRR4784764 SRR4784765 SRR4784766 SRR4784767 SRR4784768 SRR4784769 SRR4784770 SRR4784771 SRR4784772 SRR4784773 SRR4784774 SRR4784775 SRR4784776 SRR4784777 SRR4784778 SRR4784779 SRR4784780 SRR4784781 SRR4784782 SRR4784783 SRR4784784 SRR4784785 SRR4784786 SRR4784787 SRR4784788 SRR4784789 SRR4784790 SRR4784791 SRR4784792 SRR4784793 SRR4784794 SRR4784795 SRR4784796 SRR4784797 SRR4784798 SRR4784799 SRR4784800 SRR4784801 SRR4784802 SRR4784803 SRR4784804 SRR4784805 SRR4784806 SRR4784807 SRR4784808 SRR4784809 SRR4784810 SRR4784811 SRR4784812 SRR4784813 SRR4784814 SRR4784815 SRR4784816 SRR4784817 SRR4784818 SRR4784819 SRR4784820 SRR4784821 SRR4784822 SRR4784823 SRR4784824 SRR4784825 SRR4784826 SRR4784827 SRR4784828 SRR4784829 SRR4784830 SRR4784831 SRR4784832 SRR4784833 SRR4784834 SRR4784835 SRR4784836 SRR4784837 SRR4784838 SRR4784839 SRR4784840 SRR4784841 SRR4784842 SRR4784843 SRR4784844 SRR4784845 SRR4784846 SRR4784847 SRR4784848 SRR4784849 SRR4784850 SRR4784851 SRR4784852 SRR4784853 SRR4784854 SRR4784855 SRR4784856 SRR4784857 SRR4784858 SRR4784859 SRR4784860 SRR4784861 SRR4784862 SRR4784863 SRR4784864 SRR4784865 SRR4784866 SRR4784867 SRR4784868 SRR4784869 SRR4784870 SRR4784871 SRR4784872 SRR4784873 SRR4784874 SRR4784875 SRR4784876 SRR4784877 SRR4784878 SRR4784879 SRR4784880 SRR4784881 SRR4784882 SRR4784883 SRR4784884 SRR4784885 SRR4784886 SRR4784887 SRR4784888 SRR4784889 SRR4784890 SRR4784891 SRR4784892 SRR4784893 SRR4784894 SRR4784895 SRR4784896 SRR4784897 SRR4784898 SRR4784899 SRR4784900 SRR4784901 SRR4784902 SRR4784903 SRR4784904 SRR4784905 SRR4784906 SRR4784907 SRR4784908 SRR4784909 SRR4784910 SRR4784911 SRR4784912 SRR4784913 SRR4784914 SRR4784915 SRR4784916 SRR4784917 SRR4784918 SRR4784919 SRR4784920 SRR4784921 SRR4784922 SRR4784923 SRR4784924 SRR4784925 SRR4784926 SRR4784927 SRR4784928 SRR4784929 SRR4784930 SRR4784931 SRR4784932 SRR4784933 SRR4784934 SRR4784935 SRR4784936 SRR4784937 SRR4784938 SRR4784939 SRR4784940 SRR4784941 SRR4784942 SRR4784943 SRR4784944 SRR4784945 SRR4784946 SRR4784947 SRR4784948 SRR4784949 SRR4784950 SRR4784951 SRR4784952 SRR4784953 SRR4784954 SRR4784955 SRR4784956 SRR4784957 SRR4784958 SRR4784959 SRR4784960 SRR4784961 SRR4784962 SRR4784963 SRR4784964 SRR4784965 SRR4784966 SRR4784967 SRR4784968 SRR4784969 SRR4784970 SRR4784971 SRR4784972 SRR4784973 SRR4784974 SRR4784975 SRR4784976 SRR4784977 SRR4784978 SRR4784979 SRR4784980 SRR4784981 SRR4784982 SRR4784983 SRR4784984 SRR4784985 SRR4784986 SRR4784987 SRR4784988 SRR4784989 SRR4784990 SRR4784991 SRR4784992 SRR4784993 SRR4784994 SRR4784995 SRR4784996 SRR4784997 SRR4784998 SRR4784999 SRR4785000 SRR4785001 SRR4785002 SRR4785003 SRR4785004 SRR4785005 SRR4785006 SRR4785007 SRR4785008 SRR4785009 SRR4785010 SRR4785011 SRR4785012 SRR4785013 SRR4785014 SRR4785015 SRR4785016 SRR4785017 SRR4785018 SRR4785019 SRR4785020 SRR4785021 SRR4785022 SRR4785023 SRR4785024 SRR4785025 SRR4785026 SRR4785027 SRR4785028 SRR4785029 SRR4785030 SRR4785031 SRR4785032 SRR4785033 SRR4785034 SRR4785035 SRR4785036 SRR4785037 SRR4785038 SRR4785039 SRR4785040 SRR4785041 SRR4785042 SRR4785043 SRR4785044 SRR4785045 SRR4785046 SRR4785047 SRR4785048 SRR4785049 SRR4785050 SRR4785051 SRR4785052 SRR4785053 SRR4785054 SRR4785055 SRR4785056 SRR4785057 SRR4785058 SRR4785059 SRR4785060 SRR4785061 SRR4785062 SRR4785063 SRR4785064 SRR4785065 SRR4785066 SRR4785067 SRR4785068 SRR4785069 SRR4785070 SRR4785071 SRR4785072 SRR4785073 SRR4785074 SRR4785075 SRR4785076 SRR4785077 SRR4785078 SRR4785079 SRR4785080 SRR4785081 SRR4785082 SRR4785083 SRR4785084 SRR4785085 SRR4785086 SRR4785087 SRR4785088 SRR4785089 SRR4785090 SRR4785091 SRR4785092 SRR4785093 SRR4785094 SRR4785095 SRR4785096 SRR4785097 SRR4785098 SRR4785099 SRR4785100 SRR4785101 SRR4785102 SRR4785103 SRR4785104 SRR4785105 SRR4785106 SRR4785107 SRR4785108 SRR4785109 SRR4785110 SRR4785111 SRR4785112 SRR4785113 SRR4785114 SRR4785115 SRR4785116 SRR4785117 SRR4785118 SRR4785119 SRR4785120 SRR4785121 SRR4785122 SRR4785123 SRR4785124 SRR4785125 SRR4785126 SRR4785127 SRR4785128 SRR4785129 SRR4785130 SRR4785131 SRR4785132 SRR4785133 SRR4785134 SRR4785135 SRR4785136 SRR4785137 SRR4785138 SRR4785139 SRR4785140)
SRRID=${INPUT[$INDEX]}

SERIES_LIBRARY_LAYOUT=(PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED PAIRED)
SAMPLE_LIBRARY_LAYOUT=${SERIES_LIBRARY_LAYOUT[$INDEX]}

if [[ -e "$SRRID.tsv.gz" ]]; then
  exit
fi

prefetch --output-directory "/scratch/$USER" $SRRID | grep "\S" &> "$SRRID.log"
fasterq-dump --outdir "/scratch/$USER/$SRRID" --temp "/scratch/$USER/$SRRID" --threads 16 "/scratch/$USER/$SRRID" &>> "$SRRID.log"

if [[ $SAMPLE_LIBRARY_LAYOUT == "PAIRED" ]]; then
  nextflow run -profile singularity -revision 1.4.2 -work-dir "/scratch/$USER/$SRRID/work" nf-core/rnaseq --reads "/scratch/$USER/$SRRID/*{1,2}.fastq" --genome GRCh38 --skipBiotypeQC --outdir "/scratch/$USER/$SRRID/results" &>> "$SRRID.log"
fi

if [[ $SAMPLE_LIBRARY_LAYOUT == "SINGLE" ]]; then
  nextflow run -profile singularity -revision 1.4.2 -work-dir "/scratch/$USER/$SRRID/work" nf-core/rnaseq --reads "/scratch/$USER/$SRRID/*.fastq" --singleEnd --genome GRCh38 --skipBiotypeQC --outdir "/scratch/$USER/$SRRID/results" &>> "$SRRID.log"
fi

if [[ -n $(grep -l "Succeeded   : 13" "$SRRID.log") ]]; then
  gzip --stdout "/scratch/$USER/$SRRID/results/featureCounts/merged_gene_counts.txt" > "$SRRID.tsv.gz"
fi

rm -rf "/scratch/$USER/$SRRID"

